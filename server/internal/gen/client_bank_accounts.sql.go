// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: client_bank_accounts.sql

package gen

import (
	"context"

	"github.com/google/uuid"
)

const addSupportedCurrency = `-- name: AddSupportedCurrency :exec
UPDATE client_organizations
SET supported_currencies = array_append(supported_currencies, $2),
    updated_at = now()
WHERE id = $1
  AND NOT ($2 = ANY(supported_currencies))
`

type AddSupportedCurrencyParams struct {
	ID          uuid.UUID   `db:"id"`
	ArrayAppend interface{} `db:"array_append"`
}

// Add a single currency to supported list
func (q *Queries) AddSupportedCurrency(ctx context.Context, arg AddSupportedCurrencyParams) error {
	_, err := q.db.Exec(ctx, addSupportedCurrency, arg.ID, arg.ArrayAppend)
	return err
}

const getClientBankAccounts = `-- name: GetClientBankAccounts :one
SELECT
  id,
  bank_accounts
FROM client_organizations
WHERE id = $1
`

type GetClientBankAccountsRow struct {
	ID           uuid.UUID `db:"id"`
	BankAccounts []byte    `db:"bank_accounts"`
}

// Get all bank accounts for a client
func (q *Queries) GetClientBankAccounts(ctx context.Context, id uuid.UUID) (GetClientBankAccountsRow, error) {
	row := q.db.QueryRow(ctx, getClientBankAccounts, id)
	var i GetClientBankAccountsRow
	err := row.Scan(&i.ID, &i.BankAccounts)
	return i, err
}

const removeSupportedCurrency = `-- name: RemoveSupportedCurrency :exec
UPDATE client_organizations
SET supported_currencies = array_remove(supported_currencies, $2),
    updated_at = now()
WHERE id = $1
`

type RemoveSupportedCurrencyParams struct {
	ID          uuid.UUID   `db:"id"`
	ArrayRemove interface{} `db:"array_remove"`
}

// Remove a currency from supported list
func (q *Queries) RemoveSupportedCurrency(ctx context.Context, arg RemoveSupportedCurrencyParams) error {
	_, err := q.db.Exec(ctx, removeSupportedCurrency, arg.ID, arg.ArrayRemove)
	return err
}

const updateClientBankAccounts = `-- name: UpdateClientBankAccounts :exec

UPDATE client_organizations
SET bank_accounts = $1::jsonb,
    updated_at = now()
WHERE id = $2
`

type UpdateClientBankAccountsParams struct {
	BankAccounts []byte    `db:"bank_accounts"`
	ID           uuid.UUID `db:"id"`
}

// ============================================
// CLIENT BANK ACCOUNT QUERIES
// ============================================
// Manages client's bank accounts for withdrawal/off-ramp (one account per currency)
//
// Bank Account Structure (JSONB):
//
//	{
//	  "currency": "THB",
//	  "bank_name": "Kasikorn Bank",
//	  "account_number": "123-4-56789-0",
//	  "account_name": "Company (Thailand) Co., Ltd.",
//	  "bank_details": {
//	    "swift_code": "KASITHBK",
//	    "bank_code": "004",
//	    "branch_code": "0001",
//	    "promptpay_id": "0891234567"
//	  }
//	}
//
// Replace entire bank_accounts array (simpler for SQLC)
func (q *Queries) UpdateClientBankAccounts(ctx context.Context, arg UpdateClientBankAccountsParams) error {
	_, err := q.db.Exec(ctx, updateClientBankAccounts, arg.BankAccounts, arg.ID)
	return err
}

const updateClientSupportedCurrencies = `-- name: UpdateClientSupportedCurrencies :exec
UPDATE client_organizations
SET supported_currencies = $2,
    updated_at = now()
WHERE id = $1
`

type UpdateClientSupportedCurrenciesParams struct {
	ID                  uuid.UUID `db:"id"`
	SupportedCurrencies []string  `db:"supported_currencies"`
}

// Update supported currencies array
func (q *Queries) UpdateClientSupportedCurrencies(ctx context.Context, arg UpdateClientSupportedCurrenciesParams) error {
	_, err := q.db.Exec(ctx, updateClientSupportedCurrencies, arg.ID, arg.SupportedCurrencies)
	return err
}
